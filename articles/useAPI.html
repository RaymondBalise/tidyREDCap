<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Importing from REDCap • tidyREDCap</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Importing from REDCap">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyREDCap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/dropLabels.html">Drop Labels from a Table</a></li>
    <li><a class="dropdown-item" href="../articles/import_instruments.html">Import All Instruments from a REDCap Project</a></li>
    <li><a class="dropdown-item" href="../articles/makeBinaryWord.html">Make Binary Word</a></li>
    <li><a class="dropdown-item" href="../articles/makeChooseAllTable.html">Make a 'Choose All' Table</a></li>
    <li><a class="dropdown-item" href="../articles/makeChooseOneTable.html">Make a 'Choose One' Table</a></li>
    <li><a class="dropdown-item" href="../articles/makeInstrument.html">Make an Instrument</a></li>
    <li><a class="dropdown-item" href="../articles/useAPI.html">Importing from REDCap</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RaymondBalise/tidyREDCap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Importing from REDCap</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RaymondBalise/tidyREDCap/blob/master/vignettes/useAPI.Rmd" class="external-link"><code>vignettes/useAPI.Rmd</code></a></small>
      <div class="d-none name"><code>useAPI.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://raymondbalise.github.io/tidyREDCap/">tidyREDCap</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="loading-redcap-data-into-r-with-an-api-request">Loading REDCap Data into R with an API request<a class="anchor" aria-label="anchor" href="#loading-redcap-data-into-r-with-an-api-request"></a>
</h2>
<p>While most people use the “Data Exports, Reports and Stats”
Application built into REDCap, another handy method to get data out of
REDCap is an API request. An API allows one program to request data from
another program. For example, an add-on package in R can request data
from your instance of REDCap. Obviously, an R package can not
<em>type</em> your user name and password. Instead, you will store an
API token, a password, on your machine and then ask R to look up that
token and pass it to REDCap whenever you want data.</p>
<p>We have used two R packages to access our REDCap
projects,<code>redcapAPI</code> and <code>REDCapR</code>. Unfortunately,
<code>redcapAPI</code> is no longer being actively developed, and we
have run into problems with it. It had the lovely benefit of exporting
variables, basically using the same variable names as you see in REDCap,
then tagging the variables with the “labels” subjects viewed when
completing the forms.</p>
<p>We have taken the labeling functionality and added it in
tidyREDCap.</p>
<div class="section level4">
<h4 id="getting-an-api-token">Getting an API Token<a class="anchor" aria-label="anchor" href="#getting-an-api-token"></a>
</h4>
<p>If your REDCap project has API access enabled, you will see it in the
applications on the left side of the screen.</p>
<p><img src="key.jpg" alt="How to obtain an API key from the REDCap dashboard"></p>
<p>If you don’t see that option, talk to your project leader or the
REDCap system administrator.</p>
<p>When you click the link you will be given the option to create an API
Token for this project.</p>
<p>Once you have that token created, you can copy and paste it somewhere
safe.</p>
</div>
<div class="section level4">
<h4 id="protecting-your-api-tokens">Protecting Your API Tokens<a class="anchor" aria-label="anchor" href="#protecting-your-api-tokens"></a>
</h4>
<p>Leaders in the REDCap community have developed techniques for safely
storing your REDCap API keys. Ask your REDCap systems administrators how
they prefer you store API keys on your “local machine”.</p>
<div class="section level5">
<h5 id="never-do-this">NEVER DO THIS!<a class="anchor" aria-label="anchor" href="#never-do-this"></a>
</h5>
<p>The functions that allow you to export data need you to give them
your API token. Remember, this is the same information as your username
and password. <strong>NEVER</strong> type that directly in your code.
That is if your REDCap API key is “1A2B3CXXYYZZOOMMGOSHNOOOOX1Y2Z3” do
NOT do this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Do not type your API token directly into your code</span></span>
<span><span class="fu">tidyREDCap</span><span class="fu">::</span><span class="fu"><a href="../reference/import_instruments.html">import_instruments</a></span><span class="op">(</span></span>
<span>  <span class="st">"https://redcap.miami.edu/api/"</span>,</span>
<span>  <span class="st">"1A2B3CXXYYZZOOMMGOSHNOOOOX1Y2Z3"</span> <span class="co"># This is BAD!</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you do this, anybody who gets a copy of your code will be able to
access your REDCap project. Also, whenever your run this line of code,
the API token will be saved into your R history files.</p>
</div>
<div class="section level5">
<h5 id="better-options">Better Options<a class="anchor" aria-label="anchor" href="#better-options"></a>
</h5>
<p>You can save your API keys into your operating system’s built-in
password manager (i.e., macOS Keychain, Windows Credential Manager, or
the Secret Service API (GNOME Keyring/KWallet) on Linux). There are
several packages available to do this. We recommend using either <a href="https://keyring.r-lib.org/" class="external-link"><code>keyring</code></a> or <a href="https://cran.r-project.org/package=shelter" class="external-link"><code>shelter</code></a>.
<code>shelter</code> is a <a href="https://github.com/vubiostat/shelter?tab=readme-ov-file#differences-from-keyring" class="external-link">solid
choice</a> for users working with multiple operating systems. If you
primarily work with one operating system, we recommend using
<code>keyring</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"keyring"</span><span class="op">)</span></span></code></pre></div>
<p>To save your key, use code like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">keyring</span><span class="fu">::</span><span class="fu">key_set</span><span class="op">(</span><span class="st">"nacho_anxiety_key"</span><span class="op">)</span></span></code></pre></div>
<p>A box will appear where you can enter your key. After doing that, you
can access the key like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tidyREDCap</span><span class="fu">::</span><span class="fu"><a href="../reference/import_instruments.html">import_instruments</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"https://redcap.miami.edu/api/"</span>, </span>
<span>  token <span class="op">=</span> <span class="fu">keyring</span><span class="fu">::</span><span class="fu">key_get</span><span class="op">(</span><span class="st">"nacho_anxiety_key"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In the future, your operating system may ask you to enter your
computer’s password to access the key.</p>
<p>If you want to use the redcapAPI or the REDCapR packages directly you
can use the same trickery to pass your API key to their functions. For
example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rcon</span> <span class="op">&lt;-</span> <span class="fu">redcapAPI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/redcapAPI/man/redcapConnection.html" class="external-link">redcapConnection</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">'https://redcap.miami.edu/api/'</span>, </span>
<span>  token <span class="op">=</span> <span class="fu">keyring</span><span class="fu">::</span><span class="fu">key_get</span><span class="op">(</span><span class="st">"nacho_anxiety_key"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">redcap</span> <span class="op">&lt;-</span> <span class="fu">redcapAPI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/redcapAPI/man/recordsMethods.html" class="external-link">exportRecords</a></span><span class="op">(</span><span class="va">rcon</span><span class="op">)</span></span></code></pre></div>
<p>If you are curious, when we made these help files, we saved the data
using the <code><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rcon</span> <span class="op">&lt;-</span> <span class="fu">redcapAPI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/redcapAPI/man/redcapConnection.html" class="external-link">redcapConnection</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">'https://redcap.miami.edu/api/'</span>, </span>
<span>  token <span class="op">=</span> <span class="fu">keyring</span><span class="fu">::</span><span class="fu">key_get</span><span class="op">(</span><span class="st">"nacho_anxiety_key"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">redcap</span> <span class="op">&lt;-</span> <span class="fu">redcapAPI</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/redcapAPI/man/recordsMethods.html" class="external-link">exportRecords</a></span><span class="op">(</span><span class="va">rcon</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">redcap</span>, file <span class="op">=</span> <span class="st">"redcap.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raymond Balise, Gabriel Odom, Kyle Grealis, Anna Calderon, Layla Bouzoubaa, Wayne DeFreitas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
